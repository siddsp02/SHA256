#include "sha256.h"

const uint256_t outputs[] = {
    {0xba7816bf, 0x8f01cfea, 0x414140de, 0x5dae2223, 0xb00361a3, 0x96177a9c, 0xb410ff61, 0xf20015ad},
    {0x248d6a61, 0xd20638b8, 0xe5c02693, 0x0c3e6039, 0xa33ce459, 0x64ff2167, 0xf6ecedd4, 0x19db06c1},
    {0xcdc76e5c, 0x9914fb92, 0x81a1c7e2, 0x84d73e67, 0xf1809a48, 0xa497200e, 0x046d39cc, 0xc7112cd0},
};

int main() {
    array(char) m[] = {
        arr_new(char, 0x61, 0x62, 0x63),
        arr_new(char,
            0x61, 0x62, 0x63, 0x64, 0x62, 0x63, 0x64, 0x65,
            0x63, 0x64, 0x65, 0x66, 0x64, 0x65, 0x66, 0x67,
            0x65, 0x66, 0x67, 0x68, 0x66, 0x67, 0x68, 0x69,
            0x67, 0x68, 0x69, 0x6a, 0x68, 0x69, 0x6a, 0x6b,
            0x69, 0x6a, 0x6b, 0x6c, 0x6a, 0x6b, 0x6c, 0x6d,
            0x6b, 0x6c, 0x6d, 0x6e, 0x6c, 0x6d, 0x6e, 0x6f,
            0x6d, 0x6e, 0x6f, 0x70, 0x6e, 0x6f, 0x70, 0x71,
        ),
        arr_fill(char, 0x61, 1000000),  // One million of 0x61.
    };
    for (size_t i = 0; i < 3; ++i) {
        char *hash = sha256(&m[i]);
        assert(memcmp(outputs[i], hash, sizeof(uint256_t)) == 0);
        print_u256(hash);
        free(hash);
        arr_dest(m[i]);
    }
    return 0;
}
